!function(){"use strict";var e=new class extends class{constructor(){this._listeners={}}on(e,t){(this._listeners[e]=this._listeners[e]||[]).push(t)}trigger(e,t){(this._listeners[e]||[]).forEach((e=>e(t)))}off(e){delete this._listeners[e]}}{constructor(){super(),this.defaultRPC=[{name:"ARIA2 RPC",url:"http://localhost:6800/jsonrpc"}],this.defaultUserAgent="Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36 115Browser/5.1.3",this.defaultReferer="https://115.com/",this.defaultConfigData={rpcList:this.defaultRPC,configSync:!1,sha1Check:!1,vip:!0,small:!1,interval:300,downloadPath:"",userAgent:this.defaultUserAgent,browserUserAgent:!0,referer:this.defaultReferer,headers:""},this.configData={},this.on("initConfigData",this.init.bind(this)),this.on("setConfigData",this.set.bind(this)),this.on("clearConfigData",this.clear.bind(this))}init(){chrome.storage.sync.get(null,(e=>{for(const t in e)chrome.storage.local.set({key:e[t]},(()=>{console.log("chrome first local set: %s, %s",t,e[t])}))})),chrome.storage.local.get(null,(e=>{this.configData=Object.assign({},this.defaultConfigData,e),this.trigger("updateView",this.configData)}))}getConfigData(e=null){return e?this.configData[e]:this.configData}set(e){this.configData=e,this.save(e),this.trigger("updateView",e)}save(e){for(const t in e)chrome.storage.local.set({[t]:e[t]},(()=>{console.log("chrome local set: %s, %s",t,e[t])})),!0===e.configSync&&chrome.storage.sync.set({[t]:e[t]},(()=>{console.log("chrome sync set: %s, %s",t,e[t])}))}clear(){chrome.storage.sync.clear(),chrome.storage.local.clear(),this.configData=this.defaultConfigData,this.trigger("updateView",this.configData)}};var t=new class{constructor(){this.cookies={}}httpSend({url:e,options:t},n,r){fetch(e,t).then((e=>{e.ok?e.json().then((e=>{n(e)})):r(e)})).catch((e=>{r(e)}))}getConfigData(t=null){return e.getConfigData(t)}objectToQueryString(e){return Object.keys(e).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`)).join("&")}sendToBackground(e,t,n){chrome.runtime.sendMessage({method:e,data:t},n)}showToast(e,t){window.postMessage({type:"showToast",data:{message:e,type:t}},location.origin)}getHashParameter(e){const t=window.location.hash.substr(1);return new URLSearchParams(t).get(e)}formatCookies(){const e=[];for(const t in this.cookies)e.push(`${t}=${this.cookies[t]}`);return e.join("; ")}getHeader(e="RPC"){const t=[],n=this.getConfigData("browserUserAgent");let r=this.getConfigData("userAgent");if(n){const e=navigator.userAgent;e&&e.length&&(r=e)}t.push(`User-Agent: ${r}`),t.push(`Referer: ${this.getConfigData("referer")}`),t.push(`Cookie: ${this.formatCookies()}`);const o=this.getConfigData("headers");return o&&o.split("\n").forEach((e=>{t.push(e)})),"RPC"===e?t:"aria2Cmd"===e?t.map((e=>`--header ${JSON.stringify(e)}`)).join(" "):"aria2c"===e?t.map((e=>` header=${e}`)).join("\n"):"idm"===e?t.map((e=>{const t=e.split(": ");return`${t[0].toLowerCase()}: ${t[1]}`})).join("\r\n"):void 0}parseURL(e){const t=new URL(e);let n=t.username?`${t.username}:${decodeURI(t.password)}`:null;n&&(n.includes("token:")||(n=`Basic ${btoa(n)}`));const r=t.hash.substr(1),o={},i=new URLSearchParams(r);for(const e of i){const[t,n]=e;o[t]=n.length?n:"enabled"}return{authStr:n,path:t.origin+t.pathname,options:o}}generateParameter(e,t,n){e&&e.startsWith("token")&&n.params.unshift(e);const r={url:t,options:{method:"POST",headers:{},body:JSON.stringify(n)}};return e&&e.startsWith("Basic")&&(r.options.headers.Authorization=e),r}getVersion(e,t){const{authStr:n,path:r}=this.parseURL(e);this.sendToBackground("rpcVersion",this.generateParameter(n,r,{jsonrpc:"2.0",method:"aria2.getVersion",id:1,params:[]}),(e=>{t.innerText=e?`Aria2版本为: ${e}`:"错误,请查看是否开启Aria2"}))}copyText(e){navigator.clipboard?navigator.clipboard.writeText(e).then((()=>{this.showToast("拷贝成功~","inf")})).catch((()=>{this.showToast("拷贝失败 QAQ","err")})):this.showToast("拷贝失败 QAQ","err")}requestCookies(e){return new Promise((t=>{this.sendToBackground("getCookies",e,(e=>{t(e)}))}))}aria2RPCMode(e,t){const{authStr:n,path:r,options:o}=this.parseURL(e);this.getConfigData("small")&&t.sort(((e,t)=>e.size-t.size)),t.forEach((e=>{this.cookies=e.cookies;const t={jsonrpc:"2.0",method:"aria2.addUri",id:(new Date).getTime(),params:[[e.link],{out:e.name,header:this.getHeader()}]},i=this.getConfigData("sha1Check"),s=t.params[1],a=this.getConfigData("downloadPath");if(a&&(s.dir=a),i&&(s.checksum=`sha-1=${e.sha1}`),o)for(const e in o)s[e]=o[e];this.sendToBackground("rpcData",this.generateParameter(n,r,t),(e=>{e?this.showToast("下载成功!赶紧去看看吧~","inf"):this.showToast("下载失败!是不是没有开启Aria2?","err")}))}))}aria2TXTMode(e){const t=[],n=[],r=[],o=[],i="data:text/plain;charset=utf-8,";e.forEach((e=>{this.cookies=e.cookies;let i=`aria2c -c -s10 -k1M -x16 --enable-rpc=false -o ${JSON.stringify(e.name)} ${this.getHeader("aria2Cmd")} ${JSON.stringify(e.link)}`,s=[e.link,this.getHeader("aria2c"),` out=${e.name}`].join("\n");this.getConfigData("sha1Check")&&(i+=` --checksum=sha-1=${e.sha1}`,s+=`\n checksum=sha-1=${e.sha1}`),t.push(i),n.push(s);const a=["<",e.link,this.getHeader("idm"),">"].join("\r\n");r.push(a),o.push(e.link)})),document.querySelector("#aria2CmdTxt").value=`${t.join("\n")}`,document.querySelector("#aria2Txt").href=`${i}${encodeURIComponent(n.join("\n"))}`,document.querySelector("#idmTxt").href=`${i}${encodeURIComponent(r.join("\r\n")+"\r\n")}`,document.querySelector("#downloadLinkTxt").href=`${i}${encodeURIComponent(o.join("\n"))}`,document.querySelector("#copyDownloadLinkTxt").dataset.link=o.join("\n")}};var n=new class{constructor(){this.version="0.4.3",this.updateDate="2022/10/02",e.on("updateView",(e=>{this.updateSetting(e),this.updateMenu(e)}))}init(){this.context=document.querySelector('iframe[rel="wangpan"]').contentDocument,this.addSettingUI(),this.addTextExport(),e.trigger("initConfigData")}addMenu(e,t){if(!e)return;e.insertAdjacentHTML(t,'\n      <div id="exportMenu" class="export">\n        <a class="export-button">导出下载</a>\n        <div id="aria2List" class="export-menu">\n          <a class="export-menu-item" id="batchOpen" href="javascript:void(0);">批量打开</a>\n          <a class="export-menu-item" id="aria2Text" href="javascript:void(0);">文本导出</a>\n          <a class="export-menu-item" id="settingButton" href="javascript:void(0);">设置</a>\n        </div>\n      </div>');const n=this.context.querySelector("#exportMenu");n.addEventListener("mouseenter",(()=>{n.classList.add("open-o")})),n.addEventListener("mouseleave",(()=>{n.classList.remove("open-o")}));const r=this.context.querySelector("#settingButton"),o=document.querySelector("#settingMenu");r.addEventListener("click",(e=>{o.classList.add("open-o")}));this.context.querySelector("#aria2List").addEventListener("mousedown",(e=>{e.stopPropagation()}))}addContextMenuRPCSectionWithCallback(e){const t=t=>{t.insertAdjacentHTML("beforebegin",'<div class="cell" id="more-menu-rpc-section"><ul></ul></div>'),this.mostRecentConfigData&&this.updateMenu(this.mostRecentConfigData),e&&e()},n=this.context.querySelector("body > .context-menu .cell");if(n)t(n);else if("MutationObserver"in window){const e=this.context.querySelector("body"),n=new MutationObserver((e=>{const r=this.context.querySelector("body > .context-menu .cell");r&&(n.disconnect(),t(r))}));n.observe(e,{childList:!0})}}resetMenu(){this.context.querySelectorAll("#more-menu-rpc-section li").forEach((e=>{e.remove()})),this.context.querySelectorAll(".rpc-button").forEach((e=>{e.remove()}))}updateMenu(e){this.resetMenu();const{rpcList:t}=e;let n="",r="";t.forEach((e=>{const t=`<a class="export-menu-item rpc-button" href="javascript:void(0);" data-url=${e.url}>${e.name}</a>`;n+=t,r+=`<li><a href="javascript:void(0);" data-url=${e.url}>${e.name}</a></li>`})),this.context.querySelector("#aria2List").insertAdjacentHTML("afterbegin",n);const o=this.context.querySelector("#more-menu-rpc-section ul");o&&o.insertAdjacentHTML("afterbegin",r)}addTextExport(){document.body.insertAdjacentHTML("beforeend",'\n      <div id="textMenu" class="modal text-menu">\n        <div class="modal-inner">\n          <div class="modal-header">\n            <div class="modal-title">文本导出</div>\n            <div class="modal-close">×</div>\n          </div>\n          <div class="modal-body">\n            <div class="text-menu-row">\n              <a class="text-menu-button" href="javascript:void(0);" id="aria2Txt" download="aria2c.down">存为Aria2文件</a>\n              <a class="text-menu-button" href="javascript:void(0);" id="idmTxt" download="idm.ef2">存为IDM文件</a>\n              <a class="text-menu-button" href="javascript:void(0);" id="downloadLinkTxt" download="link.txt">保存下载链接</a>\n              <a class="text-menu-button" href="javascript:void(0);" id="copyDownloadLinkTxt">拷贝下载链接</a>\n            </div>\n            <div class="text-menu-row">\n              <textarea class="text-menu-textarea" type="textarea" wrap="off" spellcheck="false" id="aria2CmdTxt"></textarea>\n            </div>\n          </div>\n        </div>\n      </div>');const e=document.querySelector("#textMenu"),n=e.querySelector(".modal-close"),r=e.querySelector("#copyDownloadLinkTxt");r.addEventListener("click",(()=>{t.copyText(r.dataset.link)})),n.addEventListener("click",(()=>{e.classList.remove("open-o"),this.resetTextExport()}))}resetTextExport(){const e=document.querySelector("#textMenu");e.querySelector("#aria2Txt").href="",e.querySelector("#idmTxt").href="",e.querySelector("#downloadLinkTxt").href="",e.querySelector("#aria2CmdTxt").value="",e.querySelector("#copyDownloadLinkTxt").dataset.link=""}addSettingUI(){const n=`\n      <div id="settingMenu" class="modal setting-menu">\n        <div class="modal-inner">\n          <div class="modal-header">\n            <div class="modal-title">导出设置</div>\n            <div class="modal-close">×</div>\n          </div>\n          <div class="modal-body">\n            <div class="setting-menu-message">\n              <label class="setting-menu-label orange-o" id="message"></label>\n            </div>\n            <div class="setting-menu-row rpc-s">\n              <div class="setting-menu-name">\n                <input class="setting-menu-input name-s" spellcheck="false">\n              </div>\n              <div class="setting-menu-value">\n                <input class="setting-menu-input url-s" spellcheck="false">\n                <a class="setting-menu-button" id="addRPC" href="javascript:void(0);">添加RPC地址</a>\n              </div>\n            </div>\x3c!-- /.setting-menu-row --\x3e\n            <div class="setting-menu-row">\n              <div class="setting-menu-name">\n                <label class="setting-menu-label">配置同步</label>\n              </div>\n              <div class="setting-menu-value">\n                <input type="checkbox" class="setting-menu-checkbox configSync-s">\n              </div>\n            </div>\x3c!-- /.setting-menu-row --\x3e\n            <div class="setting-menu-row">\n              <div class="setting-menu-name">\n                <label class="setting-menu-label">SHA1校验</label>\n              </div>\n              <div class="setting-menu-value">\n                <input type="checkbox" class="setting-menu-checkbox sha1Check-s">\n              </div>\n            </div>\x3c!-- /.setting-menu-row --\x3e\n            <div class="setting-menu-row">\n              <div class="setting-menu-name">\n                <label class="setting-menu-label">115会员</label>\n              </div>\n              <div class="setting-menu-value">\n                <input type="checkbox" class="setting-menu-checkbox vip-s">\n              </div>\n            </div>\x3c!-- /.setting-menu-row --\x3e\n            <div class="setting-menu-row">\n              <div class="setting-menu-name">\n                <label class="setting-menu-label">小文件优先</label>\n              </div>\n              <div class="setting-menu-value">\n                <input type="checkbox" class="setting-menu-checkbox small-s">\n              </div>\n            </div>\x3c!-- /.setting-menu-row --\x3e\n            <div class="setting-menu-row">\n              <div class="setting-menu-name">\n                <label class="setting-menu-label">递归下载间隔</label>\n              </div>\n              <div class="setting-menu-value">\n                <input class="setting-menu-input small-o interval-s" type="number" spellcheck="false">\n                <label class="setting-menu-label">(单位:毫秒)</label>\n                <a class="setting-menu-button version-s" id="testAria2" href="javascript:void(0);">测试连接，成功显示版本号</a>\n              </div>\n            </div>\x3c!-- /.setting-menu-row --\x3e\n            <div class="setting-menu-row">\n              <div class="setting-menu-name">\n                <label class="setting-menu-label">下载路径</label>\n              </div>\n              <div class="setting-menu-value">\n                <input class="setting-menu-input downloadPath-s" placeholder="只能设置为绝对路径" spellcheck="false">\n              </div>\n            </div>\x3c!-- /.setting-menu-row --\x3e\n            <div class="setting-menu-row">\n              <div class="setting-menu-name">\n                <label class="setting-menu-label">User-Agent</label>\n              </div>\n              <div class="setting-menu-value">\n                <input class="setting-menu-input userAgent-s" spellcheck="false">\n                <label class="setting-menu-label"></label>\n                <input type="checkbox" class="setting-menu-checkbox browser-userAgent-s">\n                <label class="setting-menu-label for-checkbox">使用浏览器 UA</label>\n              </div>\n            </div>\x3c!-- /.setting-menu-row --\x3e\n            <div class="setting-menu-row">\n              <div class="setting-menu-name">\n                <label class="setting-menu-label">Referer</label>\n              </div>\n              <div class="setting-menu-value">\n                <input class="setting-menu-input referer-s" spellcheck="false">\n              </div>\n            </div>\x3c!-- /.setting-menu-row --\x3e\n            <div class="setting-menu-row">\n              <div class="setting-menu-name">\n                <label class="setting-menu-label">Headers</label>\n              </div>\n              <div class="setting-menu-value">\n                <textarea class="setting-menu-input textarea-o headers-s" type="textarea" spellcheck="false"></textarea>\n              </div>\n            </div>\x3c!-- /.setting-menu-row --\x3e\n          </div>\x3c!-- /.setting-menu-body --\x3e\n          <div class="modal-footer">\n            <div class="setting-menu-copyright">\n              <div class="setting-menu-item">\n                <label class="setting-menu-label">&copy; Copyright</label>\n                <a class="setting-menu-link" href="https://github.com/acgotaku/115" target="_blank">雪月秋水</a>\n              </div>\n              <div class="setting-menu-item">\n                <label class="setting-menu-label">Version: ${this.version}</label>\n                <label class="setting-menu-label">Update date: ${this.updateDate}</label>\n              </div>\n            </div>\x3c!-- /.setting-menu-copyright --\x3e\n            <div class="setting-menu-operate">\n              <a class="setting-menu-button large-o blue-o" id="apply" href="javascript:void(0);">应用</a>\n              <a class="setting-menu-button large-o" id="reset" href="javascript:void(0);">重置</a>\n            </div>\n          </div>\n        </div>\n      </div>`;document.body.insertAdjacentHTML("beforeend",n);const r=document.querySelector("#settingMenu");r.querySelector(".modal-close").addEventListener("click",(()=>{r.classList.remove("open-o"),this.resetSetting()}));document.querySelector("#addRPC").addEventListener("click",(()=>{const e=document.querySelectorAll(".rpc-s");Array.from(e).pop().insertAdjacentHTML("afterend",'\n        <div class="setting-menu-row rpc-s">\n          <div class="setting-menu-name">\n            <input class="setting-menu-input name-s" spellcheck="false">\n          </div>\n          <div class="setting-menu-value">\n            <input class="setting-menu-input url-s" spellcheck="false">\n          </div>\n        </div>\x3c!-- /.setting-menu-row --\x3e')}));const o=document.querySelector("#apply"),i=document.querySelector("#message");o.addEventListener("click",(()=>{this.saveSetting(),i.innerText="设置已保存"}));document.querySelector("#reset").addEventListener("click",(()=>{e.trigger("clearConfigData"),i.innerText="设置已重置"}));const s=document.querySelector("#testAria2");s.addEventListener("click",(()=>{t.getVersion(e.getConfigData("rpcList")[0].url,s)}));const a=document.querySelector(".userAgent-s"),u=document.querySelector(".browser-userAgent-s");u.addEventListener("change",(()=>{a.disabled=u.checked}))}resetSetting(){document.querySelector("#message").innerText="";document.querySelector("#testAria2").innerText="测试连接，成功显示版本号"}updateSetting(e){const{rpcList:t,configSync:n,sha1Check:r,vip:o,small:i,interval:s,downloadPath:a,userAgent:u,browserUserAgent:l,referer:c,headers:p}=e;document.querySelectorAll(".rpc-s").forEach(((e,t)=>{0!==t&&e.remove()})),t.forEach(((e,t)=>{const n=document.querySelectorAll(".rpc-s");if(0===t)n[t].querySelector(".name-s").value=e.name,n[t].querySelector(".url-s").value=e.url;else{const t=`\n          <div class="setting-menu-row rpc-s">\n            <div class="setting-menu-name">\n              <input class="setting-menu-input name-s" value="${e.name}" spellcheck="false">\n            </div>\n            <div class="setting-menu-value">\n              <input class="setting-menu-input url-s" value="${e.url}" spellcheck="false">\n            </div>\n          </div>\x3c!-- /.setting-menu-row --\x3e`;Array.from(n).pop().insertAdjacentHTML("afterend",t)}})),document.querySelector(".configSync-s").checked=n,document.querySelector(".sha1Check-s").checked=r,document.querySelector(".vip-s").checked=o,document.querySelector(".small-s").checked=i,document.querySelector(".interval-s").value=s,document.querySelector(".downloadPath-s").value=a,document.querySelector(".userAgent-s").value=u,document.querySelector(".userAgent-s").disabled=l,document.querySelector(".browser-userAgent-s").checked=l,document.querySelector(".referer-s").value=c,document.querySelector(".headers-s").value=p,this.mostRecentConfigData=e}saveSetting(){const t=document.querySelectorAll(".rpc-s"),n={rpcList:Array.from(t).map((e=>{const t=e.querySelector(".name-s").value,n=e.querySelector(".url-s").value;return t&&n?{name:t,url:n}:null})).filter((e=>e)),configSync:document.querySelector(".configSync-s").checked,sha1Check:document.querySelector(".sha1Check-s").checked,vip:document.querySelector(".vip-s").checked,small:document.querySelector(".small-s").checked,interval:document.querySelector(".interval-s").value,downloadPath:document.querySelector(".downloadPath-s").value,userAgent:document.querySelector(".userAgent-s").value,browserUserAgent:document.querySelector(".browser-userAgent-s").checked,referer:document.querySelector(".referer-s").value,headers:document.querySelector(".headers-s").value};e.trigger("setConfigData",n)}};var r,o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},i={exports:{}};r=i,function(e){function t(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function n(e,n,r,o,i,s){return t((a=t(t(n,e),t(o,s)))<<(u=i)|a>>>32-u,r);var a,u}function o(e,t,r,o,i,s,a){return n(t&r|~t&o,e,t,i,s,a)}function i(e,t,r,o,i,s,a){return n(t&o|r&~o,e,t,i,s,a)}function s(e,t,r,o,i,s,a){return n(t^r^o,e,t,i,s,a)}function a(e,t,r,o,i,s,a){return n(r^(t|~o),e,t,i,s,a)}function u(e,n){var r,u,l,c,p;e[n>>5]|=128<<n%32,e[14+(n+64>>>9<<4)]=n;var h=1732584193,d=-271733879,f=-1732584194,g=271733878;for(r=0;r<e.length;r+=16)u=h,l=d,c=f,p=g,h=o(h,d,f,g,e[r],7,-680876936),g=o(g,h,d,f,e[r+1],12,-389564586),f=o(f,g,h,d,e[r+2],17,606105819),d=o(d,f,g,h,e[r+3],22,-1044525330),h=o(h,d,f,g,e[r+4],7,-176418897),g=o(g,h,d,f,e[r+5],12,1200080426),f=o(f,g,h,d,e[r+6],17,-1473231341),d=o(d,f,g,h,e[r+7],22,-45705983),h=o(h,d,f,g,e[r+8],7,1770035416),g=o(g,h,d,f,e[r+9],12,-1958414417),f=o(f,g,h,d,e[r+10],17,-42063),d=o(d,f,g,h,e[r+11],22,-1990404162),h=o(h,d,f,g,e[r+12],7,1804603682),g=o(g,h,d,f,e[r+13],12,-40341101),f=o(f,g,h,d,e[r+14],17,-1502002290),h=i(h,d=o(d,f,g,h,e[r+15],22,1236535329),f,g,e[r+1],5,-165796510),g=i(g,h,d,f,e[r+6],9,-1069501632),f=i(f,g,h,d,e[r+11],14,643717713),d=i(d,f,g,h,e[r],20,-373897302),h=i(h,d,f,g,e[r+5],5,-701558691),g=i(g,h,d,f,e[r+10],9,38016083),f=i(f,g,h,d,e[r+15],14,-660478335),d=i(d,f,g,h,e[r+4],20,-405537848),h=i(h,d,f,g,e[r+9],5,568446438),g=i(g,h,d,f,e[r+14],9,-1019803690),f=i(f,g,h,d,e[r+3],14,-187363961),d=i(d,f,g,h,e[r+8],20,1163531501),h=i(h,d,f,g,e[r+13],5,-1444681467),g=i(g,h,d,f,e[r+2],9,-51403784),f=i(f,g,h,d,e[r+7],14,1735328473),h=s(h,d=i(d,f,g,h,e[r+12],20,-1926607734),f,g,e[r+5],4,-378558),g=s(g,h,d,f,e[r+8],11,-2022574463),f=s(f,g,h,d,e[r+11],16,1839030562),d=s(d,f,g,h,e[r+14],23,-35309556),h=s(h,d,f,g,e[r+1],4,-1530992060),g=s(g,h,d,f,e[r+4],11,1272893353),f=s(f,g,h,d,e[r+7],16,-155497632),d=s(d,f,g,h,e[r+10],23,-1094730640),h=s(h,d,f,g,e[r+13],4,681279174),g=s(g,h,d,f,e[r],11,-358537222),f=s(f,g,h,d,e[r+3],16,-722521979),d=s(d,f,g,h,e[r+6],23,76029189),h=s(h,d,f,g,e[r+9],4,-640364487),g=s(g,h,d,f,e[r+12],11,-421815835),f=s(f,g,h,d,e[r+15],16,530742520),h=a(h,d=s(d,f,g,h,e[r+2],23,-995338651),f,g,e[r],6,-198630844),g=a(g,h,d,f,e[r+7],10,1126891415),f=a(f,g,h,d,e[r+14],15,-1416354905),d=a(d,f,g,h,e[r+5],21,-57434055),h=a(h,d,f,g,e[r+12],6,1700485571),g=a(g,h,d,f,e[r+3],10,-1894986606),f=a(f,g,h,d,e[r+10],15,-1051523),d=a(d,f,g,h,e[r+1],21,-2054922799),h=a(h,d,f,g,e[r+8],6,1873313359),g=a(g,h,d,f,e[r+15],10,-30611744),f=a(f,g,h,d,e[r+6],15,-1560198380),d=a(d,f,g,h,e[r+13],21,1309151649),h=a(h,d,f,g,e[r+4],6,-145523070),g=a(g,h,d,f,e[r+11],10,-1120210379),f=a(f,g,h,d,e[r+2],15,718787259),d=a(d,f,g,h,e[r+9],21,-343485551),h=t(h,u),d=t(d,l),f=t(f,c),g=t(g,p);return[h,d,f,g]}function l(e){var t,n="",r=32*e.length;for(t=0;t<r;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function c(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;var r=8*e.length;for(t=0;t<r;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function p(e){var t,n,r="0123456789abcdef",o="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),o+=r.charAt(t>>>4&15)+r.charAt(15&t);return o}function h(e){return unescape(encodeURIComponent(e))}function d(e){return function(e){return l(u(c(e),8*e.length))}(h(e))}function f(e,t){return function(e,t){var n,r,o=c(e),i=[],s=[];for(i[15]=s[15]=void 0,o.length>16&&(o=u(o,8*e.length)),n=0;n<16;n+=1)i[n]=909522486^o[n],s[n]=1549556828^o[n];return r=u(i.concat(c(t)),512+8*t.length),l(u(s.concat(r),640))}(h(e),h(t))}function g(e,t,n){return t?n?f(t,e):p(f(t,e)):n?d(e):p(d(e))}r.exports?r.exports=g:e.md5=g}(o);var s=i.exports,a={exports:{}};!function(e){var t=function(e){var n=1e7,r=9007199254740992,o=h(r),i="0123456789abcdefghijklmnopqrstuvwxyz",s="function"==typeof BigInt;function a(e,t,n,r){return void 0===e?a[0]:void 0!==t&&(10!=+t||n)?H(e,t,n,r):Q(e)}function u(e,t){this.value=e,this.sign=t,this.isSmall=!1}function l(e){this.value=e,this.sign=e<0,this.isSmall=!0}function c(e){this.value=e}function p(e){return-r<e&&e<r}function h(e){return e<1e7?[e]:e<1e14?[e%1e7,Math.floor(e/1e7)]:[e%1e7,Math.floor(e/1e7)%1e7,Math.floor(e/1e14)]}function d(e){f(e);var t=e.length;if(t<4&&L(e,o)<0)switch(t){case 0:return 0;case 1:return e[0];case 2:return e[0]+e[1]*n;default:return e[0]+(e[1]+e[2]*n)*n}return e}function f(e){for(var t=e.length;0===e[--t];);e.length=t+1}function g(e){for(var t=new Array(e),n=-1;++n<e;)t[n]=0;return t}function v(e){return e>0?Math.floor(e):Math.ceil(e)}function m(e,t){var r,o,i=e.length,s=t.length,a=new Array(i),u=0,l=n;for(o=0;o<s;o++)u=(r=e[o]+t[o]+u)>=l?1:0,a[o]=r-u*l;for(;o<i;)u=(r=e[o]+u)===l?1:0,a[o++]=r-u*l;return u>0&&a.push(u),a}function y(e,t){return e.length>=t.length?m(e,t):m(t,e)}function b(e,t){var r,o,i=e.length,s=new Array(i),a=n;for(o=0;o<i;o++)r=e[o]-a+t,t=Math.floor(r/a),s[o]=r-t*a,t+=1;for(;t>0;)s[o++]=t%a,t=Math.floor(t/a);return s}function w(e,t){var r,o,i=e.length,s=t.length,a=new Array(i),u=0,l=n;for(r=0;r<s;r++)(o=e[r]-u-t[r])<0?(o+=l,u=1):u=0,a[r]=o;for(r=s;r<i;r++){if(!((o=e[r]-u)<0)){a[r++]=o;break}o+=l,a[r]=o}for(;r<i;r++)a[r]=e[r];return f(a),a}function S(e,t,r){var o,i,s=e.length,a=new Array(s),c=-t,p=n;for(o=0;o<s;o++)i=e[o]+c,c=Math.floor(i/p),i%=p,a[o]=i<0?i+p:i;return"number"==typeof(a=d(a))?(r&&(a=-a),new l(a)):new u(a,r)}function x(e,t){var r,o,i,s,a=e.length,u=t.length,l=g(a+u),c=n;for(i=0;i<a;++i){s=e[i];for(var p=0;p<u;++p)r=s*t[p]+l[i+p],o=Math.floor(r/c),l[i+p]=r-o*c,l[i+p+1]+=o}return f(l),l}function k(e,t){var r,o,i=e.length,s=new Array(i),a=n,u=0;for(o=0;o<i;o++)r=e[o]*t+u,u=Math.floor(r/a),s[o]=r-u*a;for(;u>0;)s[o++]=u%a,u=Math.floor(u/a);return s}function q(e,t){for(var n=[];t-- >0;)n.push(0);return n.concat(e)}function T(e,t){var n=Math.max(e.length,t.length);if(n<=30)return x(e,t);n=Math.ceil(n/2);var r=e.slice(n),o=e.slice(0,n),i=t.slice(n),s=t.slice(0,n),a=T(o,s),u=T(r,i),l=T(y(o,r),y(s,i)),c=y(y(a,q(w(w(l,a),u),n)),q(u,2*n));return f(c),c}function C(e,t,r){return new u(e<n?k(t,e):x(t,h(e)),r)}function A(e){var t,r,o,i,s=e.length,a=g(s+s),u=n;for(o=0;o<s;o++){r=0-(i=e[o])*i;for(var l=o;l<s;l++)t=i*e[l]*2+a[o+l]+r,r=Math.floor(t/u),a[o+l]=t-r*u;a[o+s]=r}return f(a),a}function M(e,t){var n,r,o,i,s=e.length,a=g(s);for(o=0,n=s-1;n>=0;--n)o=(i=1e7*o+e[n])-(r=v(i/t))*t,a[n]=0|r;return[a,0|o]}function E(e,t){var r,o=Q(t);if(s)return[new c(e.value/o.value),new c(e.value%o.value)];var i,p=e.value,m=o.value;if(0===m)throw new Error("Cannot divide by zero");if(e.isSmall)return o.isSmall?[new l(v(p/m)),new l(p%m)]:[a[0],e];if(o.isSmall){if(1===m)return[e,a[0]];if(-1==m)return[e.negate(),a[0]];var y=Math.abs(m);if(y<n){i=d((r=M(p,y))[0]);var b=r[1];return e.sign&&(b=-b),"number"==typeof i?(e.sign!==o.sign&&(i=-i),[new l(i),new l(b)]):[new u(i,e.sign!==o.sign),new l(b)]}m=h(y)}var S=L(p,m);if(-1===S)return[a[0],e];if(0===S)return[a[e.sign===o.sign?1:-1],a[0]];r=p.length+m.length<=200?function(e,t){var r,o,i,s,a,u,l,c=e.length,p=t.length,h=n,f=g(t.length),v=t[p-1],m=Math.ceil(h/(2*v)),y=k(e,m),b=k(t,m);for(y.length<=c&&y.push(0),b.push(0),v=b[p-1],o=c-p;o>=0;o--){for(r=h-1,y[o+p]!==v&&(r=Math.floor((y[o+p]*h+y[o+p-1])/v)),i=0,s=0,u=b.length,a=0;a<u;a++)i+=r*b[a],l=Math.floor(i/h),s+=y[o+a]-(i-l*h),i=l,s<0?(y[o+a]=s+h,s=-1):(y[o+a]=s,s=0);for(;0!==s;){for(r-=1,i=0,a=0;a<u;a++)(i+=y[o+a]-h+b[a])<0?(y[o+a]=i+h,i=0):(y[o+a]=i,i=1);s+=i}f[o]=r}return y=M(y,m)[0],[d(f),d(y)]}(p,m):function(e,t){for(var r,o,i,s,a,u=e.length,l=t.length,c=[],p=[],h=n;u;)if(p.unshift(e[--u]),f(p),L(p,t)<0)c.push(0);else{i=p[(o=p.length)-1]*h+p[o-2],s=t[l-1]*h+t[l-2],o>l&&(i=(i+1)*h),r=Math.ceil(i/s);do{if(L(a=k(t,r),p)<=0)break;r--}while(r);c.push(r),p=w(p,a)}return c.reverse(),[d(c),d(p)]}(p,m),i=r[0];var x=e.sign!==o.sign,q=r[1],T=e.sign;return"number"==typeof i?(x&&(i=-i),i=new l(i)):i=new u(i,x),"number"==typeof q?(T&&(q=-q),q=new l(q)):q=new u(q,T),[i,q]}function L(e,t){if(e.length!==t.length)return e.length>t.length?1:-1;for(var n=e.length-1;n>=0;n--)if(e[n]!==t[n])return e[n]>t[n]?1:-1;return 0}function P(e){var t=e.abs();return!t.isUnit()&&(!!(t.equals(2)||t.equals(3)||t.equals(5))||!(t.isEven()||t.isDivisibleBy(3)||t.isDivisibleBy(5))&&(!!t.lesser(49)||void 0))}function D(e,n){for(var r,o,i,s=e.prev(),a=s,u=0;a.isEven();)a=a.divide(2),u++;e:for(o=0;o<n.length;o++)if(!e.lesser(n[o])&&!(i=t(n[o]).modPow(a,e)).isUnit()&&!i.equals(s)){for(r=u-1;0!=r;r--){if((i=i.square().mod(e)).isUnit())return!1;if(i.equals(s))continue e}return!1}return!0}u.prototype=Object.create(a.prototype),l.prototype=Object.create(a.prototype),c.prototype=Object.create(a.prototype),u.prototype.add=function(e){var t=Q(e);if(this.sign!==t.sign)return this.subtract(t.negate());var n=this.value,r=t.value;return t.isSmall?new u(b(n,Math.abs(r)),this.sign):new u(y(n,r),this.sign)},u.prototype.plus=u.prototype.add,l.prototype.add=function(e){var t=Q(e),n=this.value;if(n<0!==t.sign)return this.subtract(t.negate());var r=t.value;if(t.isSmall){if(p(n+r))return new l(n+r);r=h(Math.abs(r))}return new u(b(r,Math.abs(n)),n<0)},l.prototype.plus=l.prototype.add,c.prototype.add=function(e){return new c(this.value+Q(e).value)},c.prototype.plus=c.prototype.add,u.prototype.subtract=function(e){var t=Q(e);if(this.sign!==t.sign)return this.add(t.negate());var n=this.value,r=t.value;return t.isSmall?S(n,Math.abs(r),this.sign):function(e,t,n){var r;return L(e,t)>=0?r=w(e,t):(r=w(t,e),n=!n),"number"==typeof(r=d(r))?(n&&(r=-r),new l(r)):new u(r,n)}(n,r,this.sign)},u.prototype.minus=u.prototype.subtract,l.prototype.subtract=function(e){var t=Q(e),n=this.value;if(n<0!==t.sign)return this.add(t.negate());var r=t.value;return t.isSmall?new l(n-r):S(r,Math.abs(n),n>=0)},l.prototype.minus=l.prototype.subtract,c.prototype.subtract=function(e){return new c(this.value-Q(e).value)},c.prototype.minus=c.prototype.subtract,u.prototype.negate=function(){return new u(this.value,!this.sign)},l.prototype.negate=function(){var e=this.sign,t=new l(-this.value);return t.sign=!e,t},c.prototype.negate=function(){return new c(-this.value)},u.prototype.abs=function(){return new u(this.value,!1)},l.prototype.abs=function(){return new l(Math.abs(this.value))},c.prototype.abs=function(){return new c(this.value>=0?this.value:-this.value)},u.prototype.multiply=function(e){var t,r,o,i=Q(e),s=this.value,l=i.value,c=this.sign!==i.sign;if(i.isSmall){if(0===l)return a[0];if(1===l)return this;if(-1===l)return this.negate();if((t=Math.abs(l))<n)return new u(k(s,t),c);l=h(t)}return r=s.length,o=l.length,new u(-.012*r-.012*o+15e-6*r*o>0?T(s,l):x(s,l),c)},u.prototype.times=u.prototype.multiply,l.prototype._multiplyBySmall=function(e){return p(e.value*this.value)?new l(e.value*this.value):C(Math.abs(e.value),h(Math.abs(this.value)),this.sign!==e.sign)},u.prototype._multiplyBySmall=function(e){return 0===e.value?a[0]:1===e.value?this:-1===e.value?this.negate():C(Math.abs(e.value),this.value,this.sign!==e.sign)},l.prototype.multiply=function(e){return Q(e)._multiplyBySmall(this)},l.prototype.times=l.prototype.multiply,c.prototype.multiply=function(e){return new c(this.value*Q(e).value)},c.prototype.times=c.prototype.multiply,u.prototype.square=function(){return new u(A(this.value),!1)},l.prototype.square=function(){var e=this.value*this.value;return p(e)?new l(e):new u(A(h(Math.abs(this.value))),!1)},c.prototype.square=function(e){return new c(this.value*this.value)},u.prototype.divmod=function(e){var t=E(this,e);return{quotient:t[0],remainder:t[1]}},c.prototype.divmod=l.prototype.divmod=u.prototype.divmod,u.prototype.divide=function(e){return E(this,e)[0]},c.prototype.over=c.prototype.divide=function(e){return new c(this.value/Q(e).value)},l.prototype.over=l.prototype.divide=u.prototype.over=u.prototype.divide,u.prototype.mod=function(e){return E(this,e)[1]},c.prototype.mod=c.prototype.remainder=function(e){return new c(this.value%Q(e).value)},l.prototype.remainder=l.prototype.mod=u.prototype.remainder=u.prototype.mod,u.prototype.pow=function(e){var t,n,r,o=Q(e),i=this.value,s=o.value;if(0===s)return a[1];if(0===i)return a[0];if(1===i)return a[1];if(-1===i)return o.isEven()?a[1]:a[-1];if(o.sign)return a[0];if(!o.isSmall)throw new Error("The exponent "+o.toString()+" is too large.");if(this.isSmall&&p(t=Math.pow(i,s)))return new l(v(t));for(n=this,r=a[1];!0&s&&(r=r.times(n),--s),0!==s;)s/=2,n=n.square();return r},l.prototype.pow=u.prototype.pow,c.prototype.pow=function(e){var t=Q(e),n=this.value,r=t.value,o=BigInt(0),i=BigInt(1),s=BigInt(2);if(r===o)return a[1];if(n===o)return a[0];if(n===i)return a[1];if(n===BigInt(-1))return t.isEven()?a[1]:a[-1];if(t.isNegative())return new c(o);for(var u=this,l=a[1];(r&i)===i&&(l=l.times(u),--r),r!==o;)r/=s,u=u.square();return l},u.prototype.modPow=function(e,t){if(e=Q(e),(t=Q(t)).isZero())throw new Error("Cannot take modPow with modulus 0");var n=a[1],r=this.mod(t);for(e.isNegative()&&(e=e.multiply(a[-1]),r=r.modInv(t));e.isPositive();){if(r.isZero())return a[0];e.isOdd()&&(n=n.multiply(r).mod(t)),e=e.divide(2),r=r.square().mod(t)}return n},c.prototype.modPow=l.prototype.modPow=u.prototype.modPow,u.prototype.compareAbs=function(e){var t=Q(e),n=this.value,r=t.value;return t.isSmall?1:L(n,r)},l.prototype.compareAbs=function(e){var t=Q(e),n=Math.abs(this.value),r=t.value;return t.isSmall?n===(r=Math.abs(r))?0:n>r?1:-1:-1},c.prototype.compareAbs=function(e){var t=this.value,n=Q(e).value;return(t=t>=0?t:-t)===(n=n>=0?n:-n)?0:t>n?1:-1},u.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=Q(e),n=this.value,r=t.value;return this.sign!==t.sign?t.sign?1:-1:t.isSmall?this.sign?-1:1:L(n,r)*(this.sign?-1:1)},u.prototype.compareTo=u.prototype.compare,l.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=Q(e),n=this.value,r=t.value;return t.isSmall?n==r?0:n>r?1:-1:n<0!==t.sign?n<0?-1:1:n<0?1:-1},l.prototype.compareTo=l.prototype.compare,c.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=this.value,n=Q(e).value;return t===n?0:t>n?1:-1},c.prototype.compareTo=c.prototype.compare,u.prototype.equals=function(e){return 0===this.compare(e)},c.prototype.eq=c.prototype.equals=l.prototype.eq=l.prototype.equals=u.prototype.eq=u.prototype.equals,u.prototype.notEquals=function(e){return 0!==this.compare(e)},c.prototype.neq=c.prototype.notEquals=l.prototype.neq=l.prototype.notEquals=u.prototype.neq=u.prototype.notEquals,u.prototype.greater=function(e){return this.compare(e)>0},c.prototype.gt=c.prototype.greater=l.prototype.gt=l.prototype.greater=u.prototype.gt=u.prototype.greater,u.prototype.lesser=function(e){return this.compare(e)<0},c.prototype.lt=c.prototype.lesser=l.prototype.lt=l.prototype.lesser=u.prototype.lt=u.prototype.lesser,u.prototype.greaterOrEquals=function(e){return this.compare(e)>=0},c.prototype.geq=c.prototype.greaterOrEquals=l.prototype.geq=l.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals,u.prototype.lesserOrEquals=function(e){return this.compare(e)<=0},c.prototype.leq=c.prototype.lesserOrEquals=l.prototype.leq=l.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals,u.prototype.isEven=function(){return 0==(1&this.value[0])},l.prototype.isEven=function(){return 0==(1&this.value)},c.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},u.prototype.isOdd=function(){return 1==(1&this.value[0])},l.prototype.isOdd=function(){return 1==(1&this.value)},c.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},u.prototype.isPositive=function(){return!this.sign},l.prototype.isPositive=function(){return this.value>0},c.prototype.isPositive=l.prototype.isPositive,u.prototype.isNegative=function(){return this.sign},l.prototype.isNegative=function(){return this.value<0},c.prototype.isNegative=l.prototype.isNegative,u.prototype.isUnit=function(){return!1},l.prototype.isUnit=function(){return 1===Math.abs(this.value)},c.prototype.isUnit=function(){return this.abs().value===BigInt(1)},u.prototype.isZero=function(){return!1},l.prototype.isZero=function(){return 0===this.value},c.prototype.isZero=function(){return this.value===BigInt(0)},u.prototype.isDivisibleBy=function(e){var t=Q(e);return!t.isZero()&&(!!t.isUnit()||(0===t.compareAbs(2)?this.isEven():this.mod(t).isZero()))},c.prototype.isDivisibleBy=l.prototype.isDivisibleBy=u.prototype.isDivisibleBy,u.prototype.isPrime=function(n){var r=P(this);if(r!==e)return r;var o=this.abs(),i=o.bitLength();if(i<=64)return D(o,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var s=Math.log(2)*i.toJSNumber(),a=Math.ceil(!0===n?2*Math.pow(s,2):s),u=[],l=0;l<a;l++)u.push(t(l+2));return D(o,u)},c.prototype.isPrime=l.prototype.isPrime=u.prototype.isPrime,u.prototype.isProbablePrime=function(n,r){var o=P(this);if(o!==e)return o;for(var i=this.abs(),s=n===e?5:n,a=[],u=0;u<s;u++)a.push(t.randBetween(2,i.minus(2),r));return D(i,a)},c.prototype.isProbablePrime=l.prototype.isProbablePrime=u.prototype.isProbablePrime,u.prototype.modInv=function(e){for(var n,r,o,i=t.zero,s=t.one,a=Q(e),u=this.abs();!u.isZero();)n=a.divide(u),r=i,o=a,i=s,a=u,s=r.subtract(n.multiply(s)),u=o.subtract(n.multiply(u));if(!a.isUnit())throw new Error(this.toString()+" and "+e.toString()+" are not co-prime");return-1===i.compare(0)&&(i=i.add(e)),this.isNegative()?i.negate():i},c.prototype.modInv=l.prototype.modInv=u.prototype.modInv,u.prototype.next=function(){var e=this.value;return this.sign?S(e,1,this.sign):new u(b(e,1),this.sign)},l.prototype.next=function(){var e=this.value;return e+1<r?new l(e+1):new u(o,!1)},c.prototype.next=function(){return new c(this.value+BigInt(1))},u.prototype.prev=function(){var e=this.value;return this.sign?new u(b(e,1),!0):S(e,1,this.sign)},l.prototype.prev=function(){var e=this.value;return e-1>-r?new l(e-1):new u(o,!0)},c.prototype.prev=function(){return new c(this.value-BigInt(1))};for(var j=[1];2*j[j.length-1]<=n;)j.push(2*j[j.length-1]);var I=j.length,N=j[I-1];function O(e){return Math.abs(e)<=n}function R(e,n,r){n=Q(n);for(var o=e.isNegative(),i=n.isNegative(),s=o?e.not():e,a=i?n.not():n,u=0,l=0,c=null,p=null,h=[];!s.isZero()||!a.isZero();)u=(c=E(s,N))[1].toJSNumber(),o&&(u=N-1-u),l=(p=E(a,N))[1].toJSNumber(),i&&(l=N-1-l),s=c[0],a=p[0],h.push(r(u,l));for(var d=0!==r(o?1:0,i?1:0)?t(-1):t(0),f=h.length-1;f>=0;f-=1)d=d.multiply(N).add(t(h[f]));return d}u.prototype.shiftLeft=function(e){var t=Q(e).toJSNumber();if(!O(t))throw new Error(String(t)+" is too large for shifting.");if(t<0)return this.shiftRight(-t);var n=this;if(n.isZero())return n;for(;t>=I;)n=n.multiply(N),t-=I-1;return n.multiply(j[t])},c.prototype.shiftLeft=l.prototype.shiftLeft=u.prototype.shiftLeft,u.prototype.shiftRight=function(e){var t,n=Q(e).toJSNumber();if(!O(n))throw new Error(String(n)+" is too large for shifting.");if(n<0)return this.shiftLeft(-n);for(var r=this;n>=I;){if(r.isZero()||r.isNegative()&&r.isUnit())return r;r=(t=E(r,N))[1].isNegative()?t[0].prev():t[0],n-=I-1}return(t=E(r,j[n]))[1].isNegative()?t[0].prev():t[0]},c.prototype.shiftRight=l.prototype.shiftRight=u.prototype.shiftRight,u.prototype.not=function(){return this.negate().prev()},c.prototype.not=l.prototype.not=u.prototype.not,u.prototype.and=function(e){return R(this,e,(function(e,t){return e&t}))},c.prototype.and=l.prototype.and=u.prototype.and,u.prototype.or=function(e){return R(this,e,(function(e,t){return e|t}))},c.prototype.or=l.prototype.or=u.prototype.or,u.prototype.xor=function(e){return R(this,e,(function(e,t){return e^t}))},c.prototype.xor=l.prototype.xor=u.prototype.xor;var $=1<<30;function B(e){var t=e.value,r="number"==typeof t?t|$:"bigint"==typeof t?t|BigInt($):t[0]+t[1]*n|1073758208;return r&-r}function U(e,n){if(n.compareTo(e)<=0){var r=U(e,n.square(n)),o=r.p,i=r.e,s=o.multiply(n);return s.compareTo(e)<=0?{p:s,e:2*i+1}:{p:o,e:2*i}}return{p:t(1),e:0}}function _(e,t){return e=Q(e),t=Q(t),e.greater(t)?e:t}function J(e,t){return e=Q(e),t=Q(t),e.lesser(t)?e:t}function F(e,t){if(e=Q(e).abs(),t=Q(t).abs(),e.equals(t))return e;if(e.isZero())return t;if(t.isZero())return e;for(var n,r,o=a[1];e.isEven()&&t.isEven();)n=J(B(e),B(t)),e=e.divide(n),t=t.divide(n),o=o.multiply(n);for(;e.isEven();)e=e.divide(B(e));do{for(;t.isEven();)t=t.divide(B(t));e.greater(t)&&(r=t,t=e,e=r),t=t.subtract(e)}while(!t.isZero());return o.isUnit()?e:e.multiply(o)}u.prototype.bitLength=function(){var e=this;return e.compareTo(t(0))<0&&(e=e.negate().subtract(t(1))),0===e.compareTo(t(0))?t(0):t(U(e,t(2)).e).add(t(1))},c.prototype.bitLength=l.prototype.bitLength=u.prototype.bitLength;var H=function(e,t,n,r){n=n||i,e=String(e),r||(e=e.toLowerCase(),n=n.toLowerCase());var o,s=e.length,a=Math.abs(t),u={};for(o=0;o<n.length;o++)u[n[o]]=o;for(o=0;o<s;o++){if("-"!==(p=e[o])&&(p in u&&u[p]>=a)){if("1"===p&&1===a)continue;throw new Error(p+" is not a valid digit in base "+t+".")}}t=Q(t);var l=[],c="-"===e[0];for(o=c?1:0;o<e.length;o++){var p;if((p=e[o])in u)l.push(Q(u[p]));else{if("<"!==p)throw new Error(p+" is not a valid character");var h=o;do{o++}while(">"!==e[o]&&o<e.length);l.push(Q(e.slice(h+1,o)))}}return Z(l,t,c)};function Z(e,t,n){var r,o=a[0],i=a[1];for(r=e.length-1;r>=0;r--)o=o.add(e[r].times(i)),i=i.times(t);return n?o.negate():o}function z(e,n){if((n=t(n)).isZero()){if(e.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(n.equals(-1)){if(e.isZero())return{value:[0],isNegative:!1};if(e.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-e.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var r=Array.apply(null,Array(e.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return r.unshift([1]),{value:[].concat.apply([],r),isNegative:!1}}var o=!1;if(e.isNegative()&&n.isPositive()&&(o=!0,e=e.abs()),n.isUnit())return e.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(e.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:o};for(var i,s=[],a=e;a.isNegative()||a.compareAbs(n)>=0;){i=a.divmod(n),a=i.quotient;var u=i.remainder;u.isNegative()&&(u=n.minus(u).abs(),a=a.next()),s.push(u.toJSNumber())}return s.push(a.toJSNumber()),{value:s.reverse(),isNegative:o}}function V(e,t,n){var r=z(e,t);return(r.isNegative?"-":"")+r.value.map((function(e){return function(e,t){return e<(t=t||i).length?t[e]:"<"+e+">"}(e,n)})).join("")}function W(e){if(p(+e)){var t=+e;if(t===v(t))return s?new c(BigInt(t)):new l(t);throw new Error("Invalid integer: "+e)}var n="-"===e[0];n&&(e=e.slice(1));var r=e.split(/e/i);if(r.length>2)throw new Error("Invalid integer: "+r.join("e"));if(2===r.length){var o=r[1];if("+"===o[0]&&(o=o.slice(1)),(o=+o)!==v(o)||!p(o))throw new Error("Invalid integer: "+o+" is not a valid exponent.");var i=r[0],a=i.indexOf(".");if(a>=0&&(o-=i.length-a-1,i=i.slice(0,a)+i.slice(a+1)),o<0)throw new Error("Cannot include negative exponent part for integers");e=i+=new Array(o+1).join("0")}if(!/^([0-9][0-9]*)$/.test(e))throw new Error("Invalid integer: "+e);if(s)return new c(BigInt(n?"-"+e:e));for(var h=[],d=e.length,g=d-7;d>0;)h.push(+e.slice(g,d)),(g-=7)<0&&(g=0),d-=7;return f(h),new u(h,n)}function Q(e){return"number"==typeof e?function(e){if(s)return new c(BigInt(e));if(p(e)){if(e!==v(e))throw new Error(e+" is not an integer.");return new l(e)}return W(e.toString())}(e):"string"==typeof e?W(e):"bigint"==typeof e?new c(e):e}u.prototype.toArray=function(e){return z(this,e)},l.prototype.toArray=function(e){return z(this,e)},c.prototype.toArray=function(e){return z(this,e)},u.prototype.toString=function(t,n){if(t===e&&(t=10),10!==t)return V(this,t,n);for(var r,o=this.value,i=o.length,s=String(o[--i]);--i>=0;)r=String(o[i]),s+="0000000".slice(r.length)+r;return(this.sign?"-":"")+s},l.prototype.toString=function(t,n){return t===e&&(t=10),10!=t?V(this,t,n):String(this.value)},c.prototype.toString=l.prototype.toString,c.prototype.toJSON=u.prototype.toJSON=l.prototype.toJSON=function(){return this.toString()},u.prototype.valueOf=function(){return parseInt(this.toString(),10)},u.prototype.toJSNumber=u.prototype.valueOf,l.prototype.valueOf=function(){return this.value},l.prototype.toJSNumber=l.prototype.valueOf,c.prototype.valueOf=c.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var X=0;X<1e3;X++)a[X]=Q(X),X>0&&(a[-X]=Q(-X));return a.one=a[1],a.zero=a[0],a.minusOne=a[-1],a.max=_,a.min=J,a.gcd=F,a.lcm=function(e,t){return e=Q(e).abs(),t=Q(t).abs(),e.divide(F(e,t)).multiply(t)},a.isInstance=function(e){return e instanceof u||e instanceof l||e instanceof c},a.randBetween=function(e,t,r){e=Q(e),t=Q(t);var o=r||Math.random,i=J(e,t),s=_(e,t).subtract(i).add(1);if(s.isSmall)return i.add(Math.floor(o()*s));for(var u=z(s,n).value,l=[],c=!0,p=0;p<u.length;p++){var h=c?u[p]+(p+1<u.length?u[p+1]/n:0):n,d=v(o()*h);l.push(d),d<u[p]&&(c=!1)}return i.add(a.fromArray(l,n,!1))},a.fromArray=function(e,t,n){return Z(e.map(Q),Q(t||10),n)},a}();e.hasOwnProperty("exports")&&(e.exports=t)}(a);var u=a.exports;class l{constructor(){this.n=u("8686980c0f5a24c4b9d43020cd2c22703ff3f450756529058b1cf88f09b8602136477198a6e2683149659bd122c33592fdb5ad47944ad1ea4d36c6b172aad6338c3bb6ac6227502d010993ac967d1aef00f0c8e038de2e4d3bc2ec368af2e9f10a6f1eda4f7262f136420c07c331b871bf139f74f3010e3c4fe57df3afb71683",16),this.e=u("10001",16)}a2hex(e){let t,n="";for(let r=0;r<e.length;r++)t=e[r].toString(16),t.length<2&&(t="0"+t),n+=t;return n}hex2a(e){let t="";for(let n=0;n<e.length;n+=2)t+=String.fromCharCode(parseInt(e.substr(n,2),16));return t}pkcs1pad2(e,t){if(t<e.length+11)return null;let n=[],r=e.length-1;for(;r>=0&&t>0;)n[--t]=e.charCodeAt(r--);for(n[--t]=0;t>2;)n[--t]=255;n[--t]=2,n[--t]=0;let o=this.a2hex(n);return u(o,16)}pkcs1unpad2(e){let t=e.toString(16);t.length%2!=0&&(t="0"+t);let n=this.hex2a(t),r=1;for(;0!==n.charCodeAt(r);)r++;return n.slice(r+1)}encrypt(e){let t=this.pkcs1pad2(e,128).modPow(this.e,this.n).toString(16);for(;t.length<256;)t="0"+t;return t}decrypt(e){let t=[],n=0;for(;n<e.length;)t[n]=e.charCodeAt(n),n+=1;let r=u(this.a2hex(t),16).modPow(this.e,this.n);return this.pkcs1unpad2(r)}}var c=new class{constructor(){this.rsa=new l,this.kts=[240,229,105,174,191,220,191,138,26,69,232,190,125,166,115,184,222,143,231,196,69,218,134,196,155,100,139,20,106,180,241,170,56,1,53,158,38,105,44,134,0,107,79,165,54,52,98,166,42,150,104,24,242,74,253,189,107,151,143,77,143,137,19,183,108,142,147,237,14,13,72,62,215,47,136,216,254,254,126,134,80,149,79,209,235,131,38,52,219,102,123,156,126,157,122,129,50,234,182,51,222,58,169,89,52,102,59,170,186,129,96,72,185,213,129,156,248,108,132,119,255,84,120,38,95,190,232,30,54,159,52,128,92,69,44,155,118,213,27,143,204,195,184,245],this.keyS=[41,35,33,94],this.keyL=[120,6,173,76,51,134,93,24,76,1,63,70]}xor115Enc(e,t,n,r){let o,i,s,a,u,l,c,p;if(a=t%4,p=[],0!==a)for(o=i=0,u=a;u>=0?i<u:i>u;o=u>=0?++i:--i)p.push(e[o]^n[o%r]);for(o=s=l=a,c=t;l<=c?s<c:s>c;o=l<=c?++s:--s)p.push(e[o]^n[(o-a)%r]);return p}getkey(e,t){let n;return null!=t?(()=>{let r,o,i;for(i=[],n=r=0,o=e;o>=0?r<o:r>o;n=o>=0?++r:--r)i.push(t[n]+this.kts[e*n]&255^this.kts[e*(e-1-n)]);return i})():12===e?this.keyL.slice(0):this.keyS.slice(0)}asymEncode(e,t){let n,r,o,i,s;for(o=117,s="",n=r=0,i=Math.floor((t+o-1)/o);i>=0?r<i:r>i;n=i>=0?++r:--r)s+=this.rsa.encrypt(this.bytesToString(e.slice(n*o,Math.min((n+1)*o,t))));return window.btoa(this.rsa.hex2a(s))}asymDecode(e,t){let n,r,o,i,s;for(o=128,s="",n=r=0,i=Math.floor((t+o-1)/o);i>=0?r<i:r>i;n=i>=0?++r:--r)s+=this.rsa.decrypt(this.bytesToString(e.slice(n*o,Math.min((n+1)*o,t))));return this.stringToBytes(s)}symEncode(e,t,n,r){let o,i,s;return o=this.getkey(4,n),i=this.getkey(12,r),s=this.xor115Enc(e,t,o,4),s.reverse(),s=this.xor115Enc(s,t,i,12),s}symDecode(e,t,n,r){let o,i,s;return o=this.getkey(4,n),i=this.getkey(12,r),s=this.xor115Enc(e,t,i,12),s.reverse(),s=this.xor115Enc(s,t,o,4),s}bytesToString(e){let t,n,r,o;for(o="",n=0,r=e.length;n<r;n++)t=e[n],o+=String.fromCharCode(t);return o}stringToBytes(e){let t,n,r,o;for(o=[],t=n=0,r=e.length;r>=0?n<r:n>r;t=r>=0?++n:--n)o.push(e.charCodeAt(t));return o}encode(e,t){const n=this.stringToBytes(s(`!@###@#${t}DFDR@#@#`));let r=this.stringToBytes(e);return r=this.symEncode(r,r.length,n,null),r=n.slice(0,16).concat(r),{data:this.asymEncode(r,r.length),key:n}}decode(e,t){let n=this.stringToBytes(window.atob(e));return n=this.asymDecode(n,n.length),this.bytesToString(this.symDecode(n.slice(16),n.length-16,t,n.slice(0,16)))}};(new class extends class{constructor(e){this.listParameter=e,this.fileDownloadInfo=[],this.currentTaskId=0,this.completedCount=0,this.folders=[],this.files={}}start(e=300,t){this.interval=e,this.done=t,this.currentTaskId=(new Date).getTime(),this.getNextFile(this.currentTaskId)}reset(){this.fileDownloadInfo=[],this.currentTaskId=0,this.folders=[],this.files={},this.completedCount=0}addFolder(e){this.folders.push(e)}addFile(e){this.files[e.pick_code]=e}getNextFile(e){if(e===this.currentTaskId)if(0!==this.folders.length){this.completedCount++,t.showToast(`正在获取文件列表... ${this.completedCount}/${this.completedCount+this.folders.length-1}`,"inf");const n=this.folders.pop();this.listParameter.search.cid=n.cate_id,t.sendToBackground("fetch",{url:`${this.listParameter.url}${t.objectToQueryString(this.listParameter.search)}`,options:this.listParameter.options},(t=>{setTimeout((()=>this.getNextFile(e)),this.interval);const r=n.path+t.path[t.path.length-1].name+"/";t.data.forEach((e=>{e.sha?this.files[e.pc]={path:r,isdir:!1,sha1:e.sha,pick_code:e.pc}:this.folders.push({cate_id:e.cid,path:r})}))}))}else 0!==this.files.length?(t.showToast("正在获取下载地址...","inf"),this.getFiles(this.files).then((()=>{this.done(this.fileDownloadInfo)}))):(t.showToast("一个文件都没有哦...","war"),this.reset())}getFiles(e){throw new Error("subclass should implement this method!")}}{constructor(){super({search:{aid:1,limit:1e3,show_dir:1,cid:""},url:`${location.protocol}//webapi.115.com/files?`,options:{credentials:"include",method:"GET"}}),this.mode="RPC",this.rpcURL="http://localhost:6800/jsonrpc",this.iframe=document.querySelector('iframe[rel="wangpan"]')}initialize(){return this.context=document.querySelector('iframe[rel="wangpan"]').contentDocument,n.init(),n.addMenu(this.context.querySelector("#js_top_panel_box"),"afterbegin"),this.context.querySelector(".right-tvf").style.display="block",this.addMenuButtonEventListener(),n.addContextMenuRPCSectionWithCallback((()=>{this.addContextMenuEventListener()})),t.showToast("初始化成功!","inf"),this}startListen(){const e=e=>{e.forEach((e=>{e.isdir?this.addFolder(e):this.addFile(e)})),this.start(t.getConfigData("interval"),(e=>{if("RPC"===this.mode&&t.aria2RPCMode(this.rpcURL,e),"TXT"===this.mode&&(t.aria2TXTMode(e),document.querySelector("#textMenu").classList.add("open-o")),"OPEN"===this.mode)for(const t of e)window.open("https://115.com/?ct=play&ac=location&pickcode="+t.pickcode)}))};window.addEventListener("message",(n=>{const r=n.data.type;if(r&&("selected"===r||"hovered"===r)){this.reset();const r=n.data.data;if(0===r.length)return void t.showToast("请选择一下你要保存的文件哦","war");e(r)}})),this.iframe.addEventListener("load",(()=>{this.initialize(),window.postMessage({type:"refresh"},location.origin)}))}addMenuButtonEventListener(){this.context.querySelector("#aria2List").addEventListener("click",(e=>{const t=e.target.dataset.url;t&&(this.rpcURL=t,this.getSelected(),this.mode="RPC"),"aria2Text"===e.target.id&&(this.getSelected(),this.mode="TXT"),"batchOpen"===e.target.id&&(this.getSelected(),this.mode="OPEN")}))}addContextMenuEventListener(){this.context.querySelector("#more-menu-rpc-section").addEventListener("click",(e=>{const t=e.target.dataset.url;t&&(this.rpcURL=t,this.getHovered(),this.mode="RPC")}))}getSelected(){window.postMessage({type:"getSelected"},location.origin)}getHovered(){window.postMessage({type:"getHovered"},location.origin)}getFile(e){return t.getConfigData("vip")?this.getFileFromProAPI(e):this.getFileFromWebAPI(e)}getFileFromWebAPI(e){const n={credentials:"include",method:"GET"};return new Promise((r=>{t.sendToBackground("fetch",{url:`${location.protocol}//webapi.115.com/files/download?pickcode=${e}`,options:n},(n=>{if(n.file_url){const e=n.file_url.match(/.*115.com(\/.*\/)/)[1];t.requestCookies([{path:e}]).then((e=>{n.cookies=e,r(n)}))}else t.showToast("无法获取下载地址!","err"),r(e)}))}))}getFileFromProAPI(e){const n=Date.now(),r=Math.floor(n/1e3),{data:o,key:i}=c.encode(JSON.stringify({pickcode:e}),r),s={headers:{"Content-Type":"application/x-www-form-urlencoded"},credentials:"include",method:"POST",body:`data=${encodeURIComponent(o)}`};return new Promise((n=>{t.sendToBackground("fetch",{url:`https://proapi.115.com/app/chrome/downurl?t=${r}`,options:s},(r=>{if(r.state){const o=JSON.parse(c.decode(r.data,i)),s=Object.values(o).pop();s.pickcode=s.pick_code,s.file_url=s.url.url,s.file_url?t.requestCookies([{url:"https://proapi.115.com/",name:"acw_tc"}]).then((e=>{s.cookies=e,n(s)})):(t.showToast("无法获取下载地址!","err"),n(e))}else n(e)}))}))}getFiles(e){const t=Object.keys(e).map((e=>this.getFile(e)));return new Promise((n=>{Promise.all(t).then((t=>{t.forEach((t=>{this.isObject(t)?this.fileDownloadInfo.push({name:e[t.pickcode].path+t.file_name,link:t.file_url,size:t.file_size,sha1:e[t.pickcode].sha1,cookies:t.cookies,pickcode:t.pickcode}):console.log(e[t])})),n()}))}))}isObject(e){return null!==e&&"object"==typeof e}}).initialize().startListen()}();